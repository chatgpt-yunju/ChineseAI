<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>DeepSeek-R1-满血版智能助手(Deployed by 常云举)</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <style>
        /* 原有样式保持不变 */
        :root { /* ... */ }
        *,
        *::before,
        *::after { /* ... */ }
        /* ...其他原有样式... */

        /* 新增全局侧边栏样式 */
        #global-sidebar {
            position: fixed;
            top: 50%;
            transform: translateY(-50%);
            left: -200px;
            width: 250px;
            height: 400px;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 0 15px 15px 0;
            box-shadow: 3px 0 15px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
            z-index: 9998; /* 低于钉钉悬浮球 */
            backdrop-filter: blur(10px);
        }

        #global-sidebar.active {
            left: 0;
        }

        #sidebar-trigger {
            position: absolute;
            right: -40px;
            top: 50%;
            transform: translateY(-50%);
            width: 40px;
            height: 80px;
            background: var(--primary-color);
            border-radius: 0 10px 10px 0;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            transition: background 0.3s;
        }

        #sidebar-trigger:hover {
            background: #0052cc;
        }

        .sidebar-content {
            padding: 20px;
            overflow-y: auto;
            height: 100%;
        }

        #trigger-arrow {
            transition: transform 0.3s;
            font-size: 1.2em;
        }

        #global-sidebar.active #trigger-arrow {
            transform: rotate(180deg);
        }

        @media (prefers-color-scheme: dark) {
            #global-sidebar {
                background: rgba(30, 30, 30, 0.95);
            }
        }
    </style>
</head>
<body>
    <div class="ui-container">
        <h1>嗨！我是 DeepSeek-R1-满血版</h1>
        <p>我可以帮你搜索、答疑、写作，点击右下角悬浮球和我对话吧~</p>
    </div>

    <!-- 新增全局侧边栏 -->
    <div id="global-sidebar">
        <div id="sidebar-trigger">
            <span id="trigger-arrow">▶</span>
        </div>
        <div class="sidebar-content">
            <h3>快捷功能</h3>
            <ul>
                <li>历史记录</li>
                <li>收藏夹</li>
                <li>多页签管理</li>
            </ul>
        </div>
    </div>

    <div id="dingtalk-orb-container"></div>

    <script>
        // 全局侧边栏控制逻辑
        (function() {
            const initSidebar = () => {
                const sidebar = document.getElementById('global-sidebar');
                const trigger = document.getElementById('sidebar-trigger');

                // 状态恢复
                const savedState = localStorage.getItem('globalSidebarState');
                if (savedState) {
                    const { isOpen, position } = JSON.parse(savedState);
                    sidebar.classList.toggle('active', isOpen);
                    if (position) sidebar.style.top = position;
                }

                // 点击触发器
                trigger.addEventListener('click', () => {
                    sidebar.classList.toggle('active');
                    saveSidebarState();
                });

                // 拖拽功能
                let isDragging = false;
                sidebar.addEventListener('mousedown', (e) => {
                    if (e.target === trigger) return;
                    isDragging = true;
                    document.body.style.userSelect = 'none';
                });

                document.addEventListener('mousemove', (e) => {
                    if (!isDragging) return;
                    const rect = sidebar.getBoundingClientRect();
                    const newY = e.clientY - rect.height / 2;
                    sidebar.style.top = `${Math.max(0, Math.min(newY, window.innerHeight - rect.height))}px`;
                });

                document.addEventListener('mouseup', () => {
                    isDragging = false;
                    document.body.style.userSelect = '';
                    saveSidebarState();
                });
            };

            const saveSidebarState = () => {
                const sidebar = document.getElementById('global-sidebar');
                const state = {
                    isOpen: sidebar.classList.contains('active'),
                    position: sidebar.style.top
                };
                localStorage.setItem('globalSidebarState', JSON.stringify(state));
            };

            window.addEventListener('load', () => {
                initSidebar();
                
                // 跨标签页同步
                window.addEventListener('storage', (e) => {
                    if (e.key === 'globalSidebarState') {
                        const newState = JSON.parse(e.newValue);
                        const sidebar = document.getElementById('global-sidebar');
                        sidebar.classList.toggle('active', newState.isOpen);
                        sidebar.style.top = newState.position;
                    }
                });
            });
        })();

        // 原有钉钉悬浮球配置保持不变
        window.dingtalkAgentConfig = {
            code: '3AKYMk5bEY',
            position: 'right',
            offset: {
                bottom: '5vh',
                right: '5vw'
            },
            orbIcon: '',
            onReady: () => {
                console.log('钉钉悬浮球初始化完成');
            }
        };

        window.addEventListener('load', () => {
            document.body.style.cursor = 'default';
            sessionStorage.setItem('firstVisit', 'true');
        });
    </script>

    <script 
        src="https://g.alicdn.com/dingding-frontend/dd-lui-inside/0.0.5/magicOrb.js" 
        defer
        crossorigin="anonymous">
    </script>
</body>
</html>
